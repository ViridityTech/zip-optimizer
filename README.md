
### Installation Steps
1. Clone this repository
2. Install required packages:
   ```
   pip install -r requirements.txt
   ```

## Data Requirements

The application requires the following data files:
1. `addresses_with_coordinates.csv` - Clinic locations with coordinates
2. `Zipcodes Info csv.csv` - ZIP code demographic data
3. `usa_zip_codes_geo_100m.json` - GeoJSON file with ZIP code boundaries (for visualization)

### Required CSV Columns

#### Clinic Data (`addresses_with_coordinates.csv`)
- `Clinic` - Name of the clinic
- `latitude` - Latitude coordinate
- `longitude` - Longitude coordinate
- `Type` - Type of clinic (used for determining service radius)

#### ZIP Code Data (`Zipcodes Info csv.csv`)
- `zip` - ZIP code
- `population_center_latitude` - Latitude of population center
- `population_center_longitude` - Longitude of population center
- `population_count` - Population count
- `percent_bachelors_degree` - Percentage with bachelor's degree
- `percent_graduate_degree` - Percentage with graduate degree
- `percent_population_in_poverty` - Percentage in poverty
- `median_household_income` - Median household income

## Usage

### Optimizer

1. Run the optimizer:
   ```
   streamlit run optimizer.py
   ```

2. **Authentication**:
   - First, authenticate with Salesforce using your credentials
   - The application will store your authentication for the session

3. **Configuration**:
   - Set weights for geographic, demographic, and Salesforce factors
   - Configure demographic sub-weights
   - Set service radius for rural and urban clinics
   - Select clinics to process
   - Adjust the percentage of ZIP codes to optimize

4. **Save/Load Profiles**:
   - Save your configuration as a profile for future use
   - Load existing profiles to quickly apply saved settings

5. **Run Optimization**:
   - Click "Run Optimization" to process the data
   - The application will:
     - Load clinic and ZIP code data
     - Calculate distances and assign ZIP codes to clinics
     - Query Salesforce for lead counts
     - Compute scores and optimize assignments
     - Generate a CSV file with the results

### Visualizer

1. Run the visualizer:
   ```
   streamlit run visualizer.py
   ```

2. **Upload Data**:
   - Upload the optimized assignments CSV generated by the Optimizer

3. **Generate Maps**:
   - Click "Generate Maps" to create interactive maps
   - The application will:
     - Load ZIP code boundaries
     - Merge with the optimized assignments
     - Create a map for each clinic showing assigned ZIP codes
     - Color-code ZIP codes based on optimization status

4. **Download Maps**:
   - Download a ZIP file containing HTML maps for each clinic
   - An index.html file is included for easy navigation

## Optimization Methodology

The application uses a multi-factor approach to optimize ZIP code assignments:

1. **Geographic Score**:
   - Based on distance from ZIP code to clinic
   - Normalized so that closer ZIP codes receive higher scores

2. **Demographic Score**:
   - Weighted combination of population, education, poverty, and income factors
   - Each factor is normalized and weighted according to user preferences

3. **Salesforce Score**:
   - Based on lead count from the last 6 months
   - Normalized to prioritize ZIP codes with higher lead activity

4. **Final Combined Score**:
   - Weighted sum of the three main scores
   - ZIP codes are ranked by this score
   - Top percentage (user-defined) are marked as "Optimized"

## Salesforce Integration

The application integrates with Salesforce to retrieve lead data:

1. **Authentication**:
   - Requires Salesforce username, password, and security token
   - Authentication is stored for the session duration

2. **Data Query**:
   - Retrieves leads from the last 6 months
   - Counts leads by ZIP code
   - Merges this data with the optimization results

## Profiles

The application supports saving and loading configuration profiles:

1. **Save Profile**:
   - Enter a profile name and click "Save Preferences"
   - Profiles are stored as JSON files in the `profiles` directory

2. **Load Profile**:
   - Select a profile from the dropdown menu
   - All settings will be loaded automatically

## Troubleshooting

### Common Issues

1. **Authentication Errors**:
   - Verify your Salesforce credentials
   - Ensure your security token is current
   - Check your network connection

2. **Missing Data Files**:
   - Ensure all required CSV and GeoJSON files are in the correct location
   - Verify file formats and column names

3. **Visualization Issues**:
   - Make sure the GeoJSON file contains the ZIP codes in your dataset
   - Check that the optimized CSV has all required columns

## Support

For questions or issues, please contact the repository maintainer.

## License

This project is licensed under the terms specified in the GitHub repository. Please refer to the LICENSE file for more details.